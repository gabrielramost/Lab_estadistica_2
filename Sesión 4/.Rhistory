library(rio)
data=import("https://github.com/gabrielramost/Lab_estadistica_2/blob/main/Sesi%C3%B3n%204/trabajadores.sav?raw=true")
library(rio)
data=import("https://github.com/gabrielramost/Lab_estadistica_2/blob/main/Sesi%C3%B3n%204/trabajadores.sav?raw=true")
names(data)
data$sexo<-as.factor(data$sexo)
levels(data$sexo)<-c("Mujer","Hombre")
levels(data$sexo)
data$catlab<-as.ordered(data$catlab)
levels(data$catlab)<-c("Administrativo","Seguridad","Directivo")
levels(data$catlab)
data$minoría<-as.factor(data$minoría)
levels(data$minoría)<-c("No","Si")
levels(data$minoría)
data$directivo<-as.factor(data$directivo)
levels(data$directivo)<-c("No","Si")
levels(data$directivo)
modelo1<-lm(salario_actual~educ+ antiguedad + experiencia, data)
summary(modelo1)
modelo2<-lm(salario_actual~salario_inicial + antiguedad + experiencia, data)
summary(modelo2)
library(stargazer)
stargazer(modelo1,modelo2, type ="text")
tanova=anova(modelo1,modelo2)
tanova
kable(tanova,
caption = "Tabla ANOVA para comparar modelos")%>%kableExtra::kable_styling(full_width = FALSE)
tanova=anova(modelo1,modelo2)
tanova
stargazer(tanova, type = text)
stargazer(tanova)
tanova
tanova$`Pr(>F)`
tanova$Res.Df
library(modelsummary)
install.packages("modelsummary")
modelsummary(modelo1,modelo2)
library(modelsummary)
modelsummary(modelo1,modelo2)
modelsummary(modelo1,modelo2, output = "kableExtra")
models = list(modelo1,modelo2)
modelsummary(models, output = "kableExtra")
modelsummary(models, output = "text")
library(modelsummary)
models = list(modelo1,modelo2)
modelsummary(models, output = "kableExtra")
tanova=anova(modelo1,modelo2)
kable(tanova,
caption = "Tabla ANOVA para comparar modelos")%>%kableExtra::kable_styling(full_width = FALSE)
library(dplyr)
kable(tanova,
caption = "Tabla ANOVA para comparar modelos")%>%kableExtra::kable_styling(full_width = FALSE)
?kable
kable?
library(magrittr)
library(knitr)
kable(tanova,
caption = "Tabla ANOVA para comparar modelos")%>%kableExtra::kable_styling(full_width = FALSE)
tanova=anova(modelo2,modelo1)
kable(tanova,
caption = "Tabla ANOVA para comparar modelos")%>%kableExtra::kable_styling(full_width = FALSE)
tanova=anova(modelo1,modelo2)
kable(tanova,
caption = "Tabla ANOVA para comparar modelos")%>%kableExtra::kable_styling(full_width = FALSE)
library(rio)
data=import("https://github.com/gabrielramost/Lab_estadistica_2/blob/main/Sesi%C3%B3n%204/trabajadores.sav?raw=true")
names(data)
data$sexo<-as.factor(data$sexo)
levels(data$sexo)<-c("Mujer","Hombre")
levels(data$sexo)
data$catlab<-as.ordered(data$catlab)
levels(data$catlab)<-c("Administrativo","Seguridad","Directivo")
levels(data$catlab)
data$minoría<-as.factor(data$minoría)
levels(data$minoría)<-c("No","Si")
levels(data$minoría)
data$directivo<-as.factor(data$directivo)
levels(data$directivo)<-c("No","Si")
levels(data$directivo)
modelo1<-lm(salario_actual~educ+ antiguedad + experiencia, data)
summary(modelo1)
modelo2<-lm(salario_actual~salario_inicial + antiguedad + experiencia, data)
summary(modelo2)
library(stargazer)
stargazer(modelo1,modelo2, type ="text")
library(dplyr)
library(magrittr)
library(knitr)
tanova=anova(modelo1,modelo2)
kable(tanova,
caption = "Tabla ANOVA para comparar modelos")%>%kableExtra::kable_styling(full_width = FALSE)
kable(tanova,
caption = "Tabla ANOVA para comparar modelos")%>%kableExtra::kable_styling(full_width = T)
FALSE
kable(tanova,
caption = "Tabla ANOVA para comparar modelos")%>%kableExtra::kable_styling(full_width = FALSE)
tanova=anova(modelo1,modelo2. na.ommit = T)
tanova=anova(modelo1,modelo2. na.ommit)
tanova=anova(modelo1,modelo2)
kable(tanova,
caption = "Tabla ANOVA para comparar modelos")%>%kableExtra::kable_styling(full_width = FALSE)
tanova=aov(modelo1,modelo2)
tanova=anova(modelo1,modelo2)
kable(tanova,
caption = "Tabla ANOVA para comparar modelos")%>%kableExtra::kable_styling(full_width = FALSE)
taniva
tanova
modelo2<-lm(salario_actual~ antiguedad + experiencia, data)
summary(modelo2)
library(dplyr)
library(magrittr)
library(knitr)
tanova=anova(modelo1,modelo2)
tanova
kable(tanova,
caption = "Tabla ANOVA para comparar modelos")%>%kableExtra::kable_styling(full_width = FALSE)
modelo1<-lm(salario_actual~educ+ antiguedad + experiencia, data)
summary(modelo1)
modelo2<-lm(salario_actual~salario_inicial + educ + antiguedad + experiencia, data)
summary(modelo2)
library(stargazer)
stargazer(modelo1,modelo2, type ="text")
library(modelsummary)
models = list(modelo1,modelo2)
modelsummary(models, output = "kableExtra")
library(dplyr)
library(magrittr)
library(knitr)
tanova=anova(modelo1,modelo2)
tanova
kable(tanova,
caption = "Tabla ANOVA para comparar modelos")%>%kableExtra::kable_styling(full_width = FALSE)
plot(modelo2,1) #Se espera que la línea roja tienda a la horizontal
mean(modelo2$residuals) # Se espera que el promedio de los residuos sea cercano a 0
plot(modelo2,3) # Se espera que la línea roja debe tender a horizontal.
library(lmtest)
bptest(modelo2) #H0 = Modelo homocedástico, ojo aquí buscamos que sea mayor a 0.05 para cumplir con el requisito
plot(modelo2,2) # En este caso la expectativa es que los puntos se acerquen lo más posible a la línea oblicua del gráfico que representa una distribución normal
shapiro.test(modelo2$residuals) #H0= Hay normalidad
library(DescTools)
VIF(modelo2) #>5 es problemático
plot(modelo2,5) #miramos valores fuera de las lineas punteadas
checModelo2=as.data.frame(influence.measures(modelo2)$is.inf)
checModelo2[checModelo2$cook.d & checModelo2$hat,] #visualizamos valores
modelo2b=formula(scale(salario_actual)~scale(salario_inicial)+scale(educ)+scale(antiguedad)+scale(experiencia))
reg2b=lm(modelo2b,data)
model2b=list(reg2b)
modelsummary(model2b, title = "Regresion: modelo con \ncoeficientes estandarizados",
stars = TRUE,
output = "kableExtra")
